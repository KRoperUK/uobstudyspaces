---
layout: default
title: Home
---

<!-- https://projets.pavie.info/yohours/ -->

<div id="map" style="height: 35rem;">
  
</div>

<div id="card-landing" style="card-group">
</div>

<script>
  spaces = {{ site.data.studyspaces | jsonify }};

  const studySpaceIcon = L.icon({
    iconUrl: '/assets/studyspace.png',
    // shadowUrl: 'leaf-shadow.png',

    iconSize:     [32, 32], // size of the icon
    // shadowSize:   [50, 64], // size of the shadow
    iconAnchor:   [16, 16], // point of the icon which will correspond to marker's location
    // shadowAnchor: [4, 62],  // the same for the shadow
    popupAnchor:  [0,-16] // point from which the popup should open relative to the iconAnchor
  });

  tileLayers = [];

  customIcons = {};

  customIcons["heybrew"] = L.icon({
    iconUrl: '/assets/heybrew.jpeg',
    // shadowUrl: 'leaf-shadow.png',

    iconSize:     [32, 32], // size of the icon
    // shadowSize:   [50, 64], // size of the shadow
    iconAnchor:   [16, 16], // point of the icon which will correspond to marker's location
    // shadowAnchor: [4, 62],  // the same for the shadow
    popupAnchor:  [0,-16] // point from which the popup should open relative to the iconAnchor
  });

  customIcons["otherStudy"] = L.icon ({
    iconUrl: '/assets/book.svg',
    iconSize:     [32, 32], // size of the icon
    iconAnchor:   [16, 16], // point of the icon which will correspond to marker's location
    popupAnchor:  [0,-16] // point from which the popup should open relative to the iconAnchor
  });

  customIcons["starbucks"] = L.icon ({
    iconUrl: '/assets/starbucks.png',
    iconSize:     [32, 32], // size of the icon
    iconAnchor:   [16, 16], // point of the icon which will correspond to marker's location
    popupAnchor:  [0,-16] // point from which the popup should open relative to the iconAnchor
  });
  
  var map = L.map('map').setView([52.45072845817002, -1.9305795352004038], 16);
  
  tileLayers.push(OpenStreetMap_Mapnik = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
  }));

  tileLayers.push (
    Stadia_AlidadeSmooth = L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png', {
      maxZoom: 20,
      attribution: '&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
    })
  );

  tileLayers.push(
    Stadia_AlidadeSmoothDark = L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png', {
      maxZoom: 20,
      attribution: '&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
    })
  );

  var studySpaces = L.layerGroup();

  for (let campus in spaces) {
    for (let building of spaces[campus]) {

        var marker = L.marker(building.coordinates,
          {icon: building.customicon ? customIcons[building.customicon] : (campus == "Other" ? customIcons["otherStudy"] : studySpaceIcon)}
        );

        markerPopup = L.DomUtil.create('div');

        markerHeading = L.DomUtil.create('h3');
        markerHeading.style.marginTop = 0;
        markerHeading.style.marginBottom = "2px";
        markerHeading.style.color = "black";

        
        markerHeadingText = L.DomUtil.create('small');
        if (building.url) {
          markerHeadingText.innerHTML = `<a style="text-decoration: none;" href="${building.url}">` + building.name + `</a>`;
        } else {
          markerHeadingText.innerHTML = building.name;
        }
        markerHeading.appendChild(markerHeadingText);

        markerPopup.appendChild(markerHeading);

        markerList = L.DomUtil.create('ul');
        markerList.style.marginTop = 0;
        markerList.style.marginBottom = 0;

        markerListDirections = L.DomUtil.create('li');
        markerListDirectionsText = L.DomUtil.create('a');
        markerListDirectionsText.style.textDecoration = "none";
        markerListDirectionsText.href = `https://www.google.com/maps/dir/?api=1&destination=${building.coordinates[0]},${building.coordinates[1]}&travelmode=walking`;
        markerListDirectionsText.innerHTML = "Directions";
        markerListDirections.appendChild(markerListDirectionsText);

        markerList.appendChild(markerListDirections);

        if (building.opening_hours) {
          markerListOpeningHours = L.DomUtil.create('li');
          markerListOpeningHours.innerHTML = `Opening hours: ${building.opening_hours}`;
          markerList.appendChild(markerListOpeningHours);
        }

        if (building.notes) {
          markerListNotes = L.DomUtil.create('li');
          markerListNotes.innerHTML = building.notes;
          markerList.appendChild(markerListNotes);
        }

        if (building.spaces) {
          markerListSpaces = L.DomUtil.create('li');
          markerListSpaces.innerHTML = `Spaces: ${building.spaces}`;
          markerList.appendChild(markerListSpaces);
        }

        if (building.cafe) {
          markerListCafe = L.DomUtil.create('li');
          markerListCafe.innerHTML = `Has cafe`;
          markerList.appendChild(markerListCafe);
        }

        if (building.vending_machines) {
          markerListVending = L.DomUtil.create('li');
          markerListVending.innerHTML = `Has vending machines`;
          markerList.appendChild(markerListVending);
        }

        if (building.computers) {
          markerListComputers = L.DomUtil.create('li');
          markerListComputers.innerHTML = `Has computers`;
          markerList.appendChild(markerListComputers);
        }

        if (building.quiet) {
          markerListQuiet = L.DomUtil.create('li');
          markerListQuiet.innerHTML = `Has quiet study`;
          markerList.appendChild(markerListQuiet);
        }

        if (building.group) {
          markerListGroup = L.DomUtil.create('li');
          markerListGroup.innerHTML = `Has group study`;
          markerList.appendChild(markerListGroup);
        }

        markerPopup.appendChild(markerList);


        marker.bindPopup(markerPopup);
        marker.addTo(studySpaces);
    }
  }
  function handleLayerChange() {
    tileLayers[tileLayersIndex].removeFrom(map);
    tileLayersIndex = (tileLayersIndex + 1) % tileLayers.length;
    tileLayers[tileLayersIndex].addTo(map);
  }
  function handleTimingChange() {
    console.log("Timing change feature coming soon!");
  }

  studySpaces.addTo(map);

  tileLayersIndex = 0;
  tileLayers[tileLayersIndex].addTo(map);
  L.control.locate().addTo(map);

  L.Control.LayerSwap = L.Control.extend({
    onAdd: function(map) {
        var visitedD = L.DomUtil.create('div');
        var layerA = L.DomUtil.create('a');
        var timingA = L.DomUtil.create('a');

        visitedD.className = 'leaflet-bar leaflet-control';

        timingA.href="javascript:handleTimingChange()";
        timingA.innerHTML=`<i style="color: black;" class=\"fas fa-clock\"></i>`;

        layerA.href="javascript:handleLayerChange()";
        layerA.innerHTML=`<i style="color: black;" class=\"fas fa-map\"></i>`;


        visitedD.appendChild(layerA);
        visitedD.appendChild(timingA);
        
        return visitedD;
    },
    onRemove: function(map) {
        // Nothing to do here
    }
    });

  L.control.layerswap = function(opts) {
      return new L.Control.LayerSwap(opts);
  }

  L.control.layerswap({ position: 'topright' }).addTo(map);
  
</script>
